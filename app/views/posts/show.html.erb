<div class="card mb-4 rounded-3 shadow-sm">
  <div class="card-body">
    <p class="fw-bold">
      <% if @post.user.avatar.url.nil? %>
        <%= text_field_tag "", 'No avatar', class: 'avatar-show avatar-show-small' %>
      <% else %>
        <span>
          <%= image_tag @post.user.avatar.url(:large), class: 'avatar-show avatar-show-small'%>
        </span>
      <% end %>
      <%= link_to @post.user.username, profile_path(@post.user.id), class: "no-decoration" %> 
    </p>  
    <p><%= image_tag @post.picture.url(:large), class: 'content-img img-show', alt: @post.title if @post.picture? %></p>
    <p> <%= @post.body %> </p>
    <% if user_signed_in? %>
      <% if current_user.id==User.find(@post.user_id).id %>
        <hr>
        <%= link_to "Edit", edit_post_path(@post), :class => "btn btn-lg btn-outline-pink" %>
        <%= 
          link_to "Delete", post_path(@post), method: :delete, 
          data: {confirm: "Delete post?"}, :class => "btn btn-lg btn-pink" 
        %>
      <% end %>
    <% end %>
    <hr>
    <div class="card-body">
      <% @post.comments.each do |comment| %>
        <div class="card mb-2 rounded-5 shadow-sm">
          <div style="padding:10px">
            <% user = User.find(comment.user_id) %>
            <p> 
              <% if user.avatar.url.nil? %>
                <%= text_field_tag "", 'No avatar', class: 'avatar-show avatar-show-small' %>
              <% else %>
                <span>
                  <%= image_tag user.avatar.url(:large), class: 'avatar-show avatar-show-small'%>
                </span>
              <% end %>
              <%= link_to user.username, profile_path(user.id), class: "comments" %>  <%= comment.body %> 
            </p>
          </div>
        </div>
      <% end %>
    
      <%= form_with model: @post.comments.build, url: [@post, @post.comments.build] do |f| %>   
        <p>
            Comment <br>
            <%= f.text_area(:body, {:class => 'form-control'}) %>
        </p>  
        <p>
            <%= f.submit("Send", {:class => 'btn btn-lg btn-outline-pink'}) %> <!-- submit calls create method -->
        </p>
      <% end %>
    </div>
  </div>
</div>